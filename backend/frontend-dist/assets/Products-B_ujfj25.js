import{_ as dt,r as i,m as S,l as G,k as ct,c as n,a as e,b as p,d as C,v as V,q as H,s as vt,e as b,t as o,F as J,p as X,w as F,g as bt,o as u,x as Y}from"./index-CZvygxan.js";import{p as h}from"./productService-DrJwBtO8.js";const mt={class:"products"},pt={class:"card filters"},ft={class:"filter-group"},yt={class:"filter-group"},kt={class:"filter-group"},gt={key:0,class:"spinner"},Ct={key:1,class:"card"},wt={key:0,class:"empty-state"},_t={key:1,class:"table-container"},St={key:0,class:"sort-icon"},Pt={key:0,class:"sort-icon"},xt={key:0,class:"sort-icon"},ht={key:0,class:"sort-icon"},Mt={key:0,class:"sort-icon"},Lt={key:0,class:"sort-icon"},Ut={key:0,class:"sort-icon"},Vt={class:"action-buttons"},qt=["onClick"],Dt=["onClick"],$t=["onClick"],Bt={class:"pagination-container"},Et={class:"pagination-info"},Ft={class:"pagination"},Nt=["disabled"],At=["disabled"],Tt=["onClick"],It=["disabled"],Ot=["disabled"],Kt={class:"pagination-select"},Rt={class:"modal"},Qt={class:"modal-header"},jt={class:"modal-title"},zt={class:"modal-body"},Wt={class:"form-group"},Gt={class:"form-group"},Ht={class:"form-group"},Jt={class:"form-group"},Xt={key:0,class:"alert alert-error"},Yt={class:"modal-footer"},Zt=["disabled"],te={class:"modal"},ee={class:"modal-header"},se={class:"modal-title"},le={class:"modal-body text-center"},oe=["src"],ae={class:"modal modal-small"},ne={class:"modal-body"},ue={class:"delete-confirmation"},ie={class:"delete-message"},re={class:"modal-footer"},de=["disabled"],ce={__name:"Products",setup(ve){const f=bt(),N=i([]),A=i(!0),q=i(!1),T=i(!1),I=i(!1),D=i(!1),y=i(!1),P=i(""),O=i(""),K=i(""),M=i(null),w=i({status:"",lowStock:!1}),L=i(""),d=i("created_at"),m=i("desc"),r=i(1),k=i(10),c=i({id:null,name:"",sku:"",quantity:0,location:""}),R=S(()=>{let l=[...N.value];if(L.value.trim()){const t=L.value.toLowerCase();l=l.filter(a=>a.name.toLowerCase().includes(t)||a.sku.toLowerCase().includes(t)||a.location.toLowerCase().includes(t))}return l}),z=S(()=>{const l=[...R.value];return l.sort((t,a)=>{var g,x;let s,v;return d.value==="index"?0:(d.value==="created_at"?(s=new Date(t.created_at).getTime(),v=new Date(a.created_at).getTime()):d.value==="quantity"?(s=t.quantity,v=a.quantity):(s=((g=t[d.value])==null?void 0:g.toString().toLowerCase())||"",v=((x=a[d.value])==null?void 0:x.toString().toLowerCase())||""),m.value==="asc"?s>v?1:s<v?-1:0:s<v?1:s>v?-1:0)}),l}),$=S(()=>Math.ceil(z.value.length/k.value)||1),Z=S(()=>{const l=(r.value-1)*k.value,t=l+k.value;return z.value.slice(l,t)}),tt=S(()=>{const l=[],t=$.value,a=r.value,s=2;let v=Math.max(1,a-s),g=Math.min(t,a+s);a<=s&&(g=Math.min(t,s*2+1)),a>=t-s&&(v=Math.max(1,t-s*2));for(let x=v;x<=g;x++)l.push(x);return l}),Q=S(()=>(r.value-1)*k.value),et=S(()=>Math.min(Q.value+k.value,R.value.length));G(k,()=>{r.value=1}),G(L,()=>{r.value=1});const U=async()=>{A.value=!0;try{const l={};w.value.status&&(l.status=w.value.status),w.value.lowStock&&(l.low_stock="true");const t=await h.getProducts(l);N.value=t.data.data||[]}catch(l){console.error("Error fetching products:",l),f.error("Failed to load products")}finally{A.value=!1}},st=()=>{D.value=!1,c.value={id:null,name:"",sku:"",quantity:0,location:""},P.value="",q.value=!0},lt=l=>{D.value=!0,c.value={...l},P.value="",q.value=!0},B=()=>{q.value=!1},W=async()=>{var l,t;y.value=!0,P.value="";try{D.value?(await h.updateProduct(c.value.id,c.value),f.success("Product updated successfully!")):(await h.createProduct(c.value),f.success("Product created successfully!")),B(),U()}catch(a){const s=((t=(l=a.response)==null?void 0:l.data)==null?void 0:t.error)||"Failed to save product";P.value=s,f.error(s)}finally{y.value=!1}},ot=l=>{M.value=l,I.value=!0},E=()=>{I.value=!1,M.value=null},at=async()=>{if(M.value){y.value=!0;try{await h.deleteProduct(M.value.id),f.success("Product deleted successfully!"),E(),U()}catch{f.error("Failed to delete product")}finally{y.value=!1}}},nt=async()=>{try{const l=await h.exportCSV(),t=window.URL.createObjectURL(new Blob([l.data])),a=document.createElement("a");a.href=t,a.setAttribute("download","products.csv"),document.body.appendChild(a),a.click(),a.remove(),f.success("Products exported to CSV successfully!")}catch{f.error("Failed to export CSV")}},ut=async l=>{try{const t=await h.getBarcode(l);K.value=window.URL.createObjectURL(new Blob([t.data])),O.value=l,T.value=!0}catch{f.error("Failed to generate barcode")}},j=()=>{T.value=!1,K.value="",O.value=""},it=l=>l.replace("_"," ").replace(/\b\w/g,t=>t.toUpperCase()),rt=l=>new Date(l).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),_=l=>{d.value===l?m.value=m.value==="asc"?"desc":"asc":(d.value=l,m.value="asc")};return ct(()=>{U()}),(l,t)=>{var a;return u(),n("div",mt,[e("div",{class:"page-header"},[t[19]||(t[19]=e("h1",{class:"page-title"},"Products",-1)),e("div",{class:"page-actions"},[e("button",{onClick:nt,class:"btn btn-outline"}," üì• Export CSV "),e("button",{onClick:st,class:"btn btn-primary"}," ‚ûï Add Product ")])]),e("div",pt,[e("div",ft,[t[20]||(t[20]=e("label",{class:"form-label"},"Search",-1)),C(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>L.value=s),type:"text",class:"input",placeholder:"Search by name, SKU, or location..."},null,512),[[V,L.value]])]),e("div",yt,[t[22]||(t[22]=e("label",{class:"form-label"},"Filter by Status",-1)),C(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>w.value.status=s),onChange:U,class:"select"},[...t[21]||(t[21]=[e("option",{value:""},"All",-1),e("option",{value:"in_stock"},"In Stock",-1),e("option",{value:"low_stock"},"Low Stock",-1),e("option",{value:"out_of_stock"},"Out of Stock",-1)])],544),[[H,w.value.status]])]),e("div",kt,[t[23]||(t[23]=e("label",{class:"form-label"},"Show Low Stock Only",-1)),C(e("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=s=>w.value.lowStock=s),onChange:U,class:"checkbox"},null,544),[[vt,w.value.lowStock]])])]),A.value?(u(),n("div",gt)):(u(),n("div",Ct,[N.value.length===0?(u(),n("div",wt,[...t[24]||(t[24]=[e("p",null,"No products found. Add your first product to get started!",-1)])])):(u(),n("div",_t,[e("table",null,[e("thead",null,[e("tr",null,[e("th",{class:"sortable",onClick:t[3]||(t[3]=s=>_("index"))},[t[25]||(t[25]=b(" No ",-1)),d.value==="index"?(u(),n("span",St,o(m.value==="asc"?"‚Üë":"‚Üì"),1)):p("",!0)]),e("th",{class:"sortable",onClick:t[4]||(t[4]=s=>_("name"))},[t[26]||(t[26]=b(" Product Name ",-1)),d.value==="name"?(u(),n("span",Pt,o(m.value==="asc"?"‚Üë":"‚Üì"),1)):p("",!0)]),e("th",{class:"sortable",onClick:t[5]||(t[5]=s=>_("sku"))},[t[27]||(t[27]=b(" SKU ",-1)),d.value==="sku"?(u(),n("span",xt,o(m.value==="asc"?"‚Üë":"‚Üì"),1)):p("",!0)]),e("th",{class:"sortable",onClick:t[6]||(t[6]=s=>_("quantity"))},[t[28]||(t[28]=b(" Quantity ",-1)),d.value==="quantity"?(u(),n("span",ht,o(m.value==="asc"?"‚Üë":"‚Üì"),1)):p("",!0)]),e("th",{class:"sortable",onClick:t[7]||(t[7]=s=>_("location"))},[t[29]||(t[29]=b(" Location ",-1)),d.value==="location"?(u(),n("span",Mt,o(m.value==="asc"?"‚Üë":"‚Üì"),1)):p("",!0)]),e("th",{class:"sortable",onClick:t[8]||(t[8]=s=>_("status"))},[t[30]||(t[30]=b(" Status ",-1)),d.value==="status"?(u(),n("span",Lt,o(m.value==="asc"?"‚Üë":"‚Üì"),1)):p("",!0)]),e("th",{class:"sortable",onClick:t[9]||(t[9]=s=>_("created_at"))},[t[31]||(t[31]=b(" Created At ",-1)),d.value==="created_at"?(u(),n("span",Ut,o(m.value==="asc"?"‚Üë":"‚Üì"),1)):p("",!0)]),t[32]||(t[32]=e("th",null,null,-1))])]),e("tbody",null,[(u(!0),n(J,null,X(Z.value,(s,v)=>(u(),n("tr",{key:s.id},[e("td",null,o(Q.value+v+1),1),e("td",null,o(s.name),1),e("td",null,[e("code",null,o(s.sku),1)]),e("td",null,o(s.quantity),1),e("td",null,o(s.location),1),e("td",null,[e("span",{class:Y(["badge",{"badge-success":s.status==="in_stock","badge-warning":s.status==="low_stock","badge-danger":s.status==="out_of_stock"}])},o(it(s.status)),3)]),e("td",null,o(rt(s.created_at)),1),e("td",null,[e("div",Vt,[e("button",{onClick:g=>ut(s.sku),class:"icon-btn",title:"View Barcode"}," üî≤ ",8,qt),e("button",{onClick:g=>lt(s),class:"icon-btn icon-btn-primary",title:"Edit Product"}," ‚úèÔ∏è ",8,Dt),e("button",{onClick:g=>ot(s),class:"icon-btn icon-btn-danger",title:"Delete Product"}," üóëÔ∏è ",8,$t)])])]))),128))])])])),e("div",Bt,[e("div",Et," Showing "+o(Q.value+1)+" to "+o(et.value)+" of "+o(R.value.length)+" products ",1),e("div",Ft,[e("button",{onClick:t[10]||(t[10]=s=>r.value=1),disabled:r.value===1,class:"pagination-btn",title:"First Page"}," ¬´ ",8,Nt),e("button",{onClick:t[11]||(t[11]=s=>r.value--),disabled:r.value===1,class:"pagination-btn",title:"Previous Page"}," ‚Äπ ",8,At),(u(!0),n(J,null,X(tt.value,s=>(u(),n("button",{key:s,onClick:v=>r.value=s,class:Y(["pagination-btn",{active:r.value===s}])},o(s),11,Tt))),128)),e("button",{onClick:t[12]||(t[12]=s=>r.value++),disabled:r.value===$.value,class:"pagination-btn",title:"Next Page"}," ‚Ä∫ ",8,It),e("button",{onClick:t[13]||(t[13]=s=>r.value=$.value),disabled:r.value===$.value,class:"pagination-btn",title:"Last Page"}," ¬ª ",8,Ot)]),e("div",Kt,[t[34]||(t[34]=e("label",null,"Items per page:",-1)),C(e("select",{"onUpdate:modelValue":t[14]||(t[14]=s=>k.value=s),class:"select"},[...t[33]||(t[33]=[e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)])],512),[[H,k.value]])])])])),q.value?(u(),n("div",{key:2,class:"modal-overlay",onClick:F(B,["self"])},[e("div",Rt,[e("div",Qt,[e("h2",jt,o(D.value?"Edit Product":"Add New Product"),1),e("button",{onClick:B,class:"btn btn-sm btn-outline"},"‚úï")]),e("div",zt,[e("form",{onSubmit:F(W,["prevent"])},[e("div",Wt,[t[35]||(t[35]=e("label",{class:"form-label"},"Product Name *",-1)),C(e("input",{"onUpdate:modelValue":t[15]||(t[15]=s=>c.value.name=s),type:"text",class:"input",required:""},null,512),[[V,c.value.name]])]),e("div",Gt,[t[36]||(t[36]=e("label",{class:"form-label"},"SKU *",-1)),C(e("input",{"onUpdate:modelValue":t[16]||(t[16]=s=>c.value.sku=s),type:"text",class:"input",required:""},null,512),[[V,c.value.sku]])]),e("div",Ht,[t[37]||(t[37]=e("label",{class:"form-label"},"Quantity *",-1)),C(e("input",{"onUpdate:modelValue":t[17]||(t[17]=s=>c.value.quantity=s),type:"number",class:"input",min:"0",required:""},null,512),[[V,c.value.quantity,void 0,{number:!0}]])]),e("div",Jt,[t[38]||(t[38]=e("label",{class:"form-label"},"Location *",-1)),C(e("input",{"onUpdate:modelValue":t[18]||(t[18]=s=>c.value.location=s),type:"text",class:"input",placeholder:"e.g., Warehouse A, Shelf 12",required:""},null,512),[[V,c.value.location]])]),t[39]||(t[39]=e("div",{class:"form-info"},[e("p",{style:{color:"#6b7280","font-size":"0.875rem"}},[b(" ‚ÑπÔ∏è Status will be automatically set based on quantity: "),e("br"),b(" ‚Ä¢ 0 units = Out of Stock "),e("br"),b(" ‚Ä¢ 1-5 units = Low Stock "),e("br"),b(" ‚Ä¢ >5 units = In Stock ")])],-1)),P.value?(u(),n("div",Xt,o(P.value),1)):p("",!0)],32)]),e("div",Yt,[e("button",{onClick:B,class:"btn btn-secondary"},"Cancel"),e("button",{onClick:W,class:"btn btn-primary",disabled:y.value},o(y.value?"Saving...":"Save"),9,Zt)])])])):p("",!0),T.value?(u(),n("div",{key:3,class:"modal-overlay",onClick:F(j,["self"])},[e("div",te,[e("div",ee,[e("h2",se,"Barcode - "+o(O.value),1),e("button",{onClick:j,class:"btn btn-sm btn-outline"}," ‚úï ")]),e("div",le,[e("img",{src:K.value,alt:"Barcode",style:{"max-width":"100%"}},null,8,oe)]),e("div",{class:"modal-footer"},[e("button",{onClick:j,class:"btn btn-secondary"}," Close ")])])])):p("",!0),I.value?(u(),n("div",{key:4,class:"modal-overlay",onClick:F(E,["self"])},[e("div",ae,[e("div",{class:"modal-header"},[t[40]||(t[40]=e("h2",{class:"modal-title"},"Confirm Delete",-1)),e("button",{onClick:E,class:"btn btn-sm btn-outline"}," ‚úï ")]),e("div",ne,[e("div",ue,[t[43]||(t[43]=e("div",{class:"delete-icon"},"üóëÔ∏è",-1)),e("p",ie,[t[41]||(t[41]=b(" Are you sure you want to delete ",-1)),e("strong",null,o((a=M.value)==null?void 0:a.name),1),t[42]||(t[42]=b("? ",-1))]),t[44]||(t[44]=e("p",{class:"delete-warning"},"This action cannot be undone.",-1))])]),e("div",re,[e("button",{onClick:E,class:"btn btn-secondary"}," Cancel "),e("button",{onClick:at,class:"btn btn-danger",disabled:y.value},o(y.value?"Deleting...":"Delete"),9,de)])])])):p("",!0)])}}},pe=dt(ce,[["__scopeId","data-v-86440abd"]]);export{pe as default};
